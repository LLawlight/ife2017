"use strict";function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)});e(s)}return i("next")})}}var getPage=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,i,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,phantom.create();case 2:return n=e.sent,e.next=5,n.createPage(["--load-images=no"]);case 5:return i=e.sent,console.log("正在使用"+t.model+"浏览"),i.setting("userAgent",t.userAgent),i.property("viewportSize",{width:t.width,height:t.height}),r=Date.now(),e.next=12,i.open(sourchURL);case 12:if(a=e.sent,console.log("status:",a),!(t.userAgent.indexOf("iPhone")>-1)){e.next=20;break}return e.next=17,i.evaluate(function(){return $(".result.c-result").map(function(){var e={};return e.title=$(this).find(".c-title").text()||"",e.link=$(this).find("a").eq(0).attr("href")||"",e.pic=$(this).find(".c-abstract .c-img img").attr("src")||"",e.info=$(this).find(".c-abstract p").text()||"",e}).toArray()});case 17:dataList=e.sent,e.next=23;break;case 20:return e.next=22,i.evaluate(function(){return $(".result.c-container").map(function(){var e={};return e.title=$(this).find(".t").text()||"",e.link=$(this).find("a").eq(0).attr("href")||"",e.pic=$(this).find(".general_image_pic img").attr("src")||"",e.info=$(this).find(".c-abstract").text()||"",e}).toArray()});case 22:dataList=e.sent;case 23:return"success"==a?(code="1",msg="抓取成功"):(code="0",msg="抓取失败"),o={code:code,msg:msg,word:keyword,time:Date.now()-r,dataList:dataList},console.dir(o),e.next=28,n.exit();case 28:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),phantom=require("phantom");require("../../../libs/jquery-3.2.0.min.js");var devices=[{model:"iPhone5",width:320,height:568,userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"},{model:"iPhone6",width:375,height:667,userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"},{model:"iPad",width:768,height:1024,userAgent:"Mozilla/5.0 (iPad; CPU OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"}],keyword="phantom",code=void 0,msg=void 0,dataList=void 0,sourchURL="https://www.baidu.com/s?wd="+keyword;getPage(devices[Math.floor(3*Math.random())]);